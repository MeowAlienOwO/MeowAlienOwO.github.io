---
layout: post
title: "Physical Layer"
date: "2015-05-14 20:15:47 +0800"
modified: 
description: "notes on physical layer"
categories: [Computer Science, Network]
tags: [cs, network]
image:
  feature: 49604772.jpg
  credit: 加賀x赤城 | YAMAno [pixiv]
  creditlink: http://www.pixiv.net/member_illust.php?mode=medium&illust_id=49604772
comments: 
---

第二篇……不要怂就是干…… おかわり！


# 简介
物理层定义了电子，时间以及其接口的二进制数据通过信道以信号形式传输的方法。
物理层是网络的基础，其属性，比如流量，延迟与错误率决定了网络的性能。
由于物理极限的存在，网络传输数据的量是有极限的。

两个重要概念：

* 数字模块化(digital modulation)：模拟信号(analog signals)与数字信号(digital bits)之间是如何
转化的
* 多路传输方案(multiplexing schemes)：探索如何将多个会话同时在一个传输中介中传输，同时不互相影响。

## 数据传输的一般过程

1. 数据分割，封装成数据包
2. 数据包转化成二进制流
3. 二进制流转换成数字信号
4. 数字信号通过相关元件转化成模拟信号
5. 模拟信号进入网络传输

# 传输介质

* 非屏蔽双绞线(Unshielded twisted pair)：最便宜普遍的传输介质，有不同的规格，最多在100米的距离上起作用。
两条铜导线以一定规格相互缠绕，双方的电磁辐射会互相抵消。
* 同轴电缆(coaxial cable)：从内到外由铜芯(copper core)，绝缘材料(insulating material)，编织外导电体(braided outer conductor),保护塑料层(protective plastic covering)组成。
* 光纤(fiber optics)：应用全反射传输信息的方法。内部由两层玻璃构成，外层是塑料包裹。

## 传输模型

* 单向传输(simplex transmission)：数据只能向一个方向传输
* 半双向传输(half-duplex transmission)：数据在一个确定的时间点上只能向某一方传输，不过可以实现双向的信息传输。
* 双向传输(duplex transmission)：数据可以同时双向传输

## 长距离传输
导线电阻导致信号丢失，从而不能进行长距离传输。
持续的振荡信号往往比其他信号传输的更远。

# 调制

调制技术是将数字信号编码为模拟信号的方法。主要有调幅(amplitude modulation,AM)，调频(frequency modulation)，调相(phase modulation)三种方法。
所有这三种方法都需要载波信号(carrier signal)，载波信号使用一个频率来传输数据。

调幅指改变模拟信号的振幅，调频指改变模拟信号的频率，调相(?)指改变模拟信号的相位从而传输信息。

## 猫(MODEM)

猫，或曰调制解调器，用于调制数字信号为模拟信号，或者将模拟信号解调制为数字信号。双向传输需要两边都有猫。

# 线路码(line code)
线路码（英语：Line code），有时也称传输码。为了便于数字信号传输，将原始的数据码进行一定的修改就得到了线路码。举例来说，当原始数据中存在长时间连续的1或0时，接收方便很难得知每一位信号的时长，也可能误以为信号传输终结而中断通信。线路码还可增加纠错功能，适应信道的特性。常见的线路码包括AMI码、HDB3码等。


## 时钟恢复与不归零编码

时钟恢复通常在不归零编码中使用，不归零编码详见[这里](http://zh.wikipedia.org/wiki/%E4%B8%8D%E6%AD%B8%E9%9B%B6)(为何只要一半带宽？)
以下是介绍：

### NRZ
在电信学中，不归零编码 (non-return-to-zero line code, NRZ) 指的是一种二进制的讯号代码，在这种传输方式中，1 和 0 都分别由不同的电子显著状态来表现，除此之外，没有中性状态、亦没有其他种状态。这种脉冲的能量比归零代码要来得密集，但它传输时是不停歇的，这代表同步信号必须在此代码之外独自传输。

在给定一个信号频率的情况下（比如说位元率），NRZ 代码只需要曼彻斯特代码 (Manchester code) 的一半带宽。

当用于异步传输时，由于缺少中性状态，必须依靠其他种机制，来达成在同步传输中使用时钟侦测错误的资料回复工作。

NRZ-Level 本身并非一种同步系统，而更是一种编码方式，因为它可用于同步环境、或异步环境中，也就是不管有没有明确的时钟讯号，都可以运作。所以，讨论 NRZ-Level 编码是否在时钟“跳动 (clock-edge)”或“跳动之间 (between clock-edge)”并非必要的，因为每一个讯号一定都是以给定的时脉来传输的，这就暗示了讯号内在的时脉。真正的问题是，能否在接收端以当初取样时的同样频率重绘该讯号。

然而，由于 NRZ 讯号的脉冲与时钟是一致的，这就很容易看出 NRZ-Level 和其他编码方式的不同，例如前面提到的曼彻斯特代码，它需要明确的时脉资讯（即 N
RZ 和时钟的 XOR 值），还能看出与 NRZ-Mark 和 NRZ-Inverted 等编码的不同。


NRZ的一个常见编码：1 0 1 0 -> H L H L(1 -> 高电平， 0 -> 低电平)
### NRZI
一改变：“1”为物理电平上的改变。“0”为没有改变。

零改变：“0”为物理电平上的改变。“1”为没有改变。

改变发生在当下位元的时钟脉冲前缘。

但是，NRZI 会有长串的 0或1 位元出现，导致时脉回复有困难，可以使用一些编码技巧（例如游长限制）来解决。曼彻斯特代码永远有时脉信号，但传输效率比 NRZI 低。

NRZI 编码被用于磁带的录音、CD的刻录和标准 USB 的传讯。

常见的NRZI编码: 0101 -> H HLLH （高电平为基准，第一个为0表示电平不改变，第二个为1表示改变电平为低，第三个0表示电平不变仍为低，第四个1表示电平改变为高，计算方式为之前电平与当前的XOR）

### 时钟恢复(clock recovery)
我们通常使用接收方与传输方所约定的时钟频率来进行时间同步，从而确定何时对电压进行采样。
简单的来说，所谓时钟恢复就是：根据参考时钟，从数据信号把时钟信号提取出来。相对应的，在信道上只传输串行数据，在信道上并没有时钟信号。数据接收端接收串行数据并进行时钟恢复。--[百度百科](http://baike.baidu.com/view/3871116.htm)

## 曼彻斯特编码(Manchest Encoding)

0表示低电平到高电平，1表示高电平到低电平。传输每一个比特简化了时钟恢复，但是同样效率不高--传输数量与传输速度都需要倍增才能达到不归零编码的效果。
好处是可以使用电平的跳变来同步时钟。更多信息见[维基百科](http://en.wikipedia.org/wiki/Manchester_coed)，那个例子图很好。

计算曼彻斯特编码时，要使用时钟比特位与编码比特位异或。

曼彻斯特编码的例子：

0101 -> H LH HL LH HL

以太网使用曼彻斯特编码。

## 波特率(Baud Rate)

在电子通信领域，波特率（Baud）即调制速率，指的是有效数据信号调制载波的速率，即单位时间内载波调制状态变化的次数。它是对符号传输速率的一种度量，1波特即指每秒传输1个符号，而通过不同的调制方式，可以在一个码元符号上负载多个bit位信息。--[维基百科](http://zh.wikipedia.org/wiki/%E6%B3%A2%E7%89%B9%E7%8E%87)

## 帧错误(framing error)

当收发双方以不同的波特率进行通信时，容易出现帧错误的现象。

# 数据传输极限

## Nyquist Sampling Theroem

一个无噪声的(noiseless/error-free)的介质的最大传输速率：

* $D$：数据比率(bit)每秒，bps
* $B$：带宽(hz)

对于使用二进制信号的方案而言，

$Data\ Rate = D = 2B$

对于使用K阶信号的方案而言，

$D = 2B\log_2 K$

## Shannon's Theorem

这个定理针对的是有噪声介质。

信噪比(signal to noise ration)是信号长度与噪声长度之比$S / N$。
信噪比通常用分贝(decibels,db)来表示。$1db = 10 \log_10 S/N$。

对于有噪声介质的最大数据率为:

$D = B \log_2(1 + S / N)$


